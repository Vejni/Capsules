PatchWiseModel(
  (features): Sequential(
    (0): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(16, 16, kernel_size=(2, 2), stride=(2, 2))
    (7): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (10): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (11): ReLU(inplace=True)
    (12): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (13): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Conv2d(32, 32, kernel_size=(2, 2), stride=(2, 2))
    (16): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (17): ReLU(inplace=True)
    (18): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (19): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): ReLU(inplace=True)
    (21): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (22): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (23): ReLU(inplace=True)
    (24): Conv2d(64, 64, kernel_size=(2, 2), stride=(2, 2))
    (25): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (26): ReLU(inplace=True)
    (27): Conv2d(64, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (28): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (29): ReLU(inplace=True)
    (30): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (31): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (32): ReLU(inplace=True)
    (33): Conv2d(128, 128, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (34): BatchNorm2d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (35): ReLU(inplace=True)
    (36): Conv2d(128, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (37): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (38): ReLU(inplace=True)
    (39): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (40): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (41): ReLU(inplace=True)
    (42): Conv2d(256, 256, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (43): BatchNorm2d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (44): ReLU(inplace=True)
    (45): Conv2d(256, 3, kernel_size=(1, 1), stride=(1, 1))
  )
  (classifier): Sequential(
    (0): Linear(in_features=12288, out_features=4, bias=True)
  )
)
Parameters: 1990951
Trainable parameters: 1990951
Using: cuda:0
Start training network: 2021/05/14 07:31

  0%|          | 0/613 [00:00<?, ?it/s]
Using  39200 training samples
Using  2100 validation samples
Epoch 1/10
----------
100%|██████████| 613/613 [21:20<00:00,  2.09s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 1.1116 Acc: 0.5147
100%|██████████| 33/33 [00:20<00:00,  1.63it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.3395 Acc: 0.4962
Epoch 2/10
----------
100%|██████████| 613/613 [21:14<00:00,  2.08s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.8475 Acc: 0.6451
100%|██████████| 33/33 [00:20<00:00,  1.60it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.4006 Acc: 0.5238
Epoch 3/10
----------
100%|██████████| 613/613 [20:55<00:00,  2.05s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.7212 Acc: 0.7082
100%|██████████| 33/33 [00:20<00:00,  1.58it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.3407 Acc: 0.5771
Epoch 4/10
----------
100%|██████████| 613/613 [20:54<00:00,  2.05s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.6199 Acc: 0.7521
100%|██████████| 33/33 [00:20<00:00,  1.61it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.3560 Acc: 0.5943
Epoch 5/10
----------
100%|██████████| 613/613 [20:57<00:00,  2.05s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.5069 Acc: 0.8026
100%|██████████| 33/33 [00:20<00:00,  1.62it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.3597 Acc: 0.5871
Epoch 6/10
----------
100%|██████████| 613/613 [21:08<00:00,  2.07s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.4004 Acc: 0.8472
100%|██████████| 33/33 [00:20<00:00,  1.61it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.7155 Acc: 0.5138
Epoch 7/10
----------
100%|██████████| 613/613 [21:11<00:00,  2.07s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.3063 Acc: 0.8862
100%|██████████| 33/33 [00:20<00:00,  1.62it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 2.1139 Acc: 0.5610
Epoch 8/10
----------
100%|██████████| 613/613 [21:11<00:00,  2.07s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.2318 Acc: 0.9164
100%|██████████| 33/33 [00:20<00:00,  1.61it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.9942 Acc: 0.5976
Epoch 9/10
----------
100%|██████████| 613/613 [21:13<00:00,  2.08s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.1806 Acc: 0.9352
100%|██████████| 33/33 [00:20<00:00,  1.62it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.8066 Acc: 0.5671
Epoch 10/10
----------
100%|██████████| 613/613 [21:11<00:00,  2.07s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.1434 Acc: 0.9496
100%|██████████| 33/33 [00:20<00:00,  1.65it/s]
val Loss: 2.0196 Acc: 0.5719
Training complete in 214m 45s
Best Validation Accuracy: 0.597619
100%|██████████| 175/175 [00:21<00:00,  8.13it/s]
  0%|          | 0/33 [00:00<?, ?it/s]
Test Accuracy of the model: 0.60 %
100%|██████████| 33/33 [00:20<00:00,  1.58it/s]
Confusion matrix
 tensor([[301.,  60.,  32., 132.],
        [ 42., 171.,  71., 136.],
        [ 84.,  34., 375., 102.],
        [ 37.,  63.,  37., 423.]])
Class 0
TP 301.0, TN 1412.0, FP 163.0, FN 224.0
Sensitivity 0.57, Specificity 0.90, F1 0.61, Accuracy 0.82
Class 1
TP 171.0, TN 1523.0, FP 157.0, FN 249.0
Sensitivity 0.41, Specificity 0.91, F1 0.46, Accuracy 0.81
Class 2
TP 375.0, TN 1365.0, FP 140.0, FN 220.0
Sensitivity 0.63, Specificity 0.91, F1 0.68, Accuracy 0.83
Class 3
TP 423.0, TN 1170.0, FP 370.0, FN 137.0
Sensitivity 0.76, Specificity 0.76, F1 0.63, Accuracy 0.76
Model saved: ./_patchwise_BACH__patchwise_BACH_2021-05-14_07-31.ckpt

'./_patchwise_BACH__patchwise_BACH_2021-05-14_07-31.ckpt'