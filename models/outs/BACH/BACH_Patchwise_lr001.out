PatchWiseModel(
  (features): Sequential(
    (0): Conv2d(3, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (1): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (2): ReLU(inplace=True)
    (3): Conv2d(16, 16, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (4): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (5): ReLU(inplace=True)
    (6): Conv2d(16, 16, kernel_size=(2, 2), stride=(2, 2))
    (7): BatchNorm2d(16, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (8): ReLU(inplace=True)
    (9): Conv2d(16, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (10): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (11): ReLU(inplace=True)
    (12): Conv2d(32, 32, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (13): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (14): ReLU(inplace=True)
    (15): Conv2d(32, 32, kernel_size=(2, 2), stride=(2, 2))
    (16): BatchNorm2d(32, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (17): ReLU(inplace=True)
    (18): Conv2d(32, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (19): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (20): ReLU(inplace=True)
    (21): Conv2d(64, 64, kernel_size=(3, 3), stride=(1, 1), padding=(1, 1))
    (22): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (23): ReLU(inplace=True)
    (24): Conv2d(64, 64, kernel_size=(2, 2), stride=(2, 2))
    (25): BatchNorm2d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
    (26): ReLU(inplace=True)
    (27): Conv2d(64, 3, kernel_size=(1, 1), stride=(1, 1))
  )
  (classifier): Sequential(
    (0): Linear(in_features=12288, out_features=4, bias=True)
  )
)
Parameters: 143719
Trainable parameters: 143719
Using: cuda:0
Start training network: 2021/05/13 07:56

/usr/local/lib/python3.7/dist-packages/torchvision/transforms/transforms.py:1201: UserWarning: Argument resample is deprecated and will be removed since v0.10.0. Please, use interpolation instead
  "Argument resample is deprecated and will be removed since v0.10.0. Please, use interpolation instead"
  0%|          | 0/613 [00:00<?, ?it/s]Using  39208 training samples
Using  2100 validation samples
Epoch 1/10
----------
100%|██████████| 613/613 [39:21<00:00,  3.85s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 1.0469 Acc: 0.5488
100%|██████████| 33/33 [04:32<00:00,  8.27s/it]
val Loss: 1.2987 Acc: 0.5138
  0%|          | 0/613 [00:00<?, ?it/s]Epoch 2/10
----------
100%|██████████| 613/613 [23:16<00:00,  2.28s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.8279 Acc: 0.6600
100%|██████████| 33/33 [00:21<00:00,  1.51it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.3474 Acc: 0.5276
Epoch 3/10
----------
100%|██████████| 613/613 [23:07<00:00,  2.26s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.7043 Acc: 0.7186
100%|██████████| 33/33 [00:21<00:00,  1.54it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.5454 Acc: 0.4543
Epoch 4/10
----------
100%|██████████| 613/613 [23:04<00:00,  2.26s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.5704 Acc: 0.7764
100%|██████████| 33/33 [00:22<00:00,  1.48it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.3159 Acc: 0.5614
Epoch 5/10
----------
100%|██████████| 613/613 [23:45<00:00,  2.32s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.4606 Acc: 0.8241
100%|██████████| 33/33 [00:22<00:00,  1.45it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.5103 Acc: 0.5867
Epoch 6/10
----------
100%|██████████| 613/613 [23:37<00:00,  2.31s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.3665 Acc: 0.8616
100%|██████████| 33/33 [00:21<00:00,  1.50it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.7039 Acc: 0.5048
Epoch 7/10
----------
100%|██████████| 613/613 [23:24<00:00,  2.29s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.3038 Acc: 0.8866
100%|██████████| 33/33 [00:22<00:00,  1.45it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 1.9801 Acc: 0.5167
Epoch 8/10
----------
100%|██████████| 613/613 [23:49<00:00,  2.33s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.2555 Acc: 0.9038
100%|██████████| 33/33 [00:22<00:00,  1.46it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 2.2191 Acc: 0.5205
Epoch 9/10
----------
100%|██████████| 613/613 [23:32<00:00,  2.30s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.2246 Acc: 0.9171
100%|██████████| 33/33 [00:22<00:00,  1.47it/s]
  0%|          | 0/613 [00:00<?, ?it/s]
val Loss: 2.2707 Acc: 0.5100
Epoch 10/10
----------
100%|██████████| 613/613 [23:47<00:00,  2.33s/it]
  0%|          | 0/33 [00:00<?, ?it/s]
train Loss: 0.2021 Acc: 0.9248
100%|██████████| 33/33 [00:23<00:00,  1.39it/s]
val Loss: 2.2907 Acc: 0.5333
Training complete in 258m 43s
Best Validation Accuracy: 0.586667
100%|██████████| 176/176 [04:40<00:00,  1.59s/it]
  0%|          | 0/33 [00:00<?, ?it/s]Test Accuracy of the model: 0.56 %
100%|██████████| 33/33 [00:23<00:00,  1.38it/s]Confusion matrix
 tensor([[288.,  61.,  41., 135.],
        [ 48., 216.,  53., 103.],
        [106.,  97., 298.,  94.],
        [ 66., 108.,  15., 381.]])
Class 0
TP 288.0, TN 1365.0, FP 220.0, FN 237.0
Sensitivity 0.55, Specificity 0.86, F1 0.56, Accuracy 0.78
Class 1
TP 216.0, TN 1424.0, FP 266.0, FN 204.0
Sensitivity 0.51, Specificity 0.84, F1 0.48, Accuracy 0.78
Class 2
TP 298.0, TN 1406.0, FP 109.0, FN 297.0
Sensitivity 0.50, Specificity 0.93, F1 0.59, Accuracy 0.81
Class 3
TP 381.0, TN 1208.0, FP 332.0, FN 189.0
Sensitivity 0.67, Specificity 0.78, F1 0.59, Accuracy 0.75
Model saved: /content/gdrive/MyDrive/Models/_BACH_patchwise__BACH_patchwise_2021-05-13_07-56.ckpt

/content/gdrive/MyDrive/Models/_BACH_patchwise__BACH_patchwise_2021-05-13_07-56.ckpt